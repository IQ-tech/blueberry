@import '../variables.styl'

$column-padding-xsmall = 'calc((%s / 2))' % grid-fluid-gutter-xsmall
$column-padding-medium = 'calc((%s / 2))' % grid-fluid-gutter-medium

.flex-grid
	box-sizing border-box
	margin 0 auto
	padding 0 grid-fixed-margin-xsmall
	max-width grid-fixed-max-width
	display flex
	flex-direction column

	+aboveMedium()
		padding 0 grid-fixed-margin-medium

	&--fluid
		max-width none
		padding 0 grid-fluid-margin-xsmall

		+aboveMedium()
			padding 0 grid-fluid-margin-medium

	&--prototyping
		background-color blueberry-30
		position relative

		&:after, &:before
			display block
			content ''
			position absolute
			background-color blueberry-80
			top 0
			height 100%
			width grid-fixed-margin-xsmall

			+aboveMedium()
				width grid-fixed-margin-medium

		&:before
			left 0

		&:after
			right 0

	&--prototyping&--fluid
		background-color cyan-30

		&:before, &:after
			background-color cyan-80
			width grid-fluid-margin-xsmall

			+aboveMedium()
				width grid-fluid-margin-medium

	&__row
		display flex
		flex-wrap wrap
		margin 0 'calc(-%s / 2)' % grid-fluid-gutter-xsmall
		box-sizing border-box

		+aboveMedium()
			margin 0 'calc(-%s / 2)' % grid-fluid-gutter-medium

		&:not(:last-of-type)
			margin-bottom grid-fluid-gutter-xsmall

			+aboveMedium()
				margin-bottom grid-fluid-gutter-medium

		&--no-wrap
			flex-wrap none

	&--prototyping &__row
		/* background-color rgba(cyan-40, 0.9) */
		background-color transparent

	&--prototyping&--fluid &__row
		background-color rgba(blueberry-40, 0.9)

	// columns
	&__column
		background-color rgba(cyan-40, 0.9)
		padding-top 0
		flex 0 0 'calc((100% / %s) - %s)' % (grid-columns-xsmall grid-fluid-gutter-xsmall)
		margin 0 $column-padding-xsmall
		box-sizing border-box

		+aboveSmall()
			flex-basis 'calc((100% / %s))' % grid-columns-small

		+aboveMedium()
			flex-basis 'calc((100% / %s) - %s)' % (grid-columns-medium grid-fluid-gutter-medium)
			margin 0 $column-padding-medium

		// Phone columns
		&--phone-half
			flex-basis 'calc(50% - %s)' % grid-fluid-gutter-xsmall

		&--phone-full
			flex-basis 'calc(100% - %s)' % grid-fluid-gutter-xsmall

		for columnSpan in 1 .. 4
			&--phone-{columnSpan}
				flex-basis 'calc((100% / %s) * %s - %s)' % (grid-columns-xsmall columnSpan grid-fluid-gutter-xsmall)

		// Tablet columns
		&--tablet-half
			flex-basis 'calc(50% - %s)' % grid-fluid-gutter-xsmall

		&--tablet-full
			flex-basis 'calc(100% - %s)' % grid-fluid-gutter-xsmall

		for columnSpan in 1 .. 8
			&--tablet-{columnSpan}
				+aboveSmall()
					flex-basis 'calc((100% / %s) * %s - %s)' % (grid-columns-small columnSpan grid-fluid-gutter-xsmall)

		// Desktop columns
		&--desktop-half
			flex-basis 'calc(50% - %s)' % grid-fluid-gutter-medium

		&--desktop-full
			flex-basis 'calc(100% - %s)' % grid-fluid-gutter-medium

		for columnSpan in 1 .. 12
			&--desktop-{columnSpan}
				+aboveMedium()
					flex-basis 'calc((100% / %s) * %s - %s)' % (grid-columns-medium columnSpan grid-fluid-gutter-medium)
